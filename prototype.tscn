[gd_scene load_steps=21 format=3 uid="uid://bq3882tkp8hwx"]

[ext_resource type="Texture2D" uid="uid://bt043n8scsipo" path="res://icon.svg" id="1_aq8cg"]
[ext_resource type="Script" path="res://scripts/move.gd" id="1_xoidt"]
[ext_resource type="Script" path="res://scripts/move_character_back.gd" id="3_0cdfv"]
[ext_resource type="Texture2D" uid="uid://bb76chblox1qy" path="res://textures/grassMid.png" id="3_we4ca"]
[ext_resource type="Texture2D" uid="uid://c7ww3a6n54whc" path="res://textures/flagRed.png" id="4_7quu1"]
[ext_resource type="Texture2D" uid="uid://xhvgmbx5lfvs" path="res://textures/grassCenter.png" id="4_hv57n"]
[ext_resource type="Texture2D" uid="uid://cd053hfja0sbd" path="res://textures/lollipopBaseBrown.png" id="6_1swtq"]
[ext_resource type="Script" path="res://scripts/detect_finish_line_reached.gd" id="6_to2lt"]
[ext_resource type="Texture2D" uid="uid://c1s74jb6f2sxq" path="res://textures/lollipopFruitGreen.png" id="7_60v0s"]
[ext_resource type="Texture2D" uid="uid://c4rub87ujlihk" path="res://textures/lollipopFruitYellow.png" id="7_bwe1x"]
[ext_resource type="Texture2D" uid="uid://csn7lhln11087" path="res://textures/flagGreen2.png" id="8_06u38"]
[ext_resource type="Script" path="res://scripts/detect_starting_line_reached.gd" id="8_ouh8i"]
[ext_resource type="Script" path="res://scripts/instructions.gd" id="8_sdu8k"]
[ext_resource type="Script" path="res://scripts/announce_commands.gd" id="13_d88ly"]
[ext_resource type="Script" path="res://scripts/check_player_movement.gd" id="14_yfcr8"]

[sub_resource type="CapsuleShape2D" id="CapsuleShape2D_6eaqc"]
radius = 37.0
height = 74.0

[sub_resource type="RectangleShape2D" id="RectangleShape2D_24u1r"]
size = Vector2(60, 720)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_71hhf"]
size = Vector2(2160, 80)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_7xdvd"]
size = Vector2(20, 60)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_saorr"]
size = Vector2(20, 60)

[node name="Node2D" type="Node2D"]

[node name="Player" type="CharacterBody2D" parent="." groups=["player"]]
unique_name_in_owner = true
position = Vector2(73, 580)
script = ExtResource("1_xoidt")

[node name="CollisionShape2D" type="CollisionShape2D" parent="Player"]
shape = SubResource("CapsuleShape2D_6eaqc")

[node name="Sprite2D" type="Sprite2D" parent="Player"]
scale = Vector2(0.5, 0.5)
texture = ExtResource("1_aq8cg")

[node name="MoveCharacterBack" type="Node" parent="Player"]
script = ExtResource("3_0cdfv")

[node name="WallStaticBody2D" type="StaticBody2D" parent="."]
position = Vector2(0, 360)

[node name="CollisionShape2D" type="CollisionShape2D" parent="WallStaticBody2D"]
shape = SubResource("RectangleShape2D_24u1r")

[node name="Sprite2D" type="Sprite2D" parent="WallStaticBody2D"]
texture_repeat = 2
scale = Vector2(1, 25)
texture = ExtResource("4_hv57n")
region_enabled = true
region_rect = Rect2(0, 0, 70, 70)

[node name="FloorStaticBody2D" type="StaticBody2D" parent="."]
position = Vector2(0, 644)

[node name="CollisionShape2D" type="CollisionShape2D" parent="FloorStaticBody2D"]
position = Vector2(539.5, 35.5)
shape = SubResource("RectangleShape2D_71hhf")

[node name="Sprite2D" type="Sprite2D" parent="FloorStaticBody2D"]
texture_repeat = 2
position = Vector2(539.5, 36)
scale = Vector2(25.6411, 1.1)
texture = ExtResource("3_we4ca")
region_enabled = true
region_rect = Rect2(0, 0, 70, 70)

[node name="DetectFinishLineReached" type="Node" parent="."]
script = ExtResource("6_to2lt")

[node name="FinishLineArea2D" type="Area2D" parent="DetectFinishLineReached"]
position = Vector2(1013, 572)

[node name="CollisionShape2D" type="CollisionShape2D" parent="DetectFinishLineReached/FinishLineArea2D"]
scale = Vector2(-4.61429, -2.53186)
shape = SubResource("RectangleShape2D_7xdvd")

[node name="LollipopBaseBrown" type="Sprite2D" parent="DetectFinishLineReached/FinishLineArea2D"]
position = Vector2(-2, 34)
texture = ExtResource("6_1swtq")

[node name="LollipopFruitGreen" type="Sprite2D" parent="DetectFinishLineReached/FinishLineArea2D"]
position = Vector2(-2, -37)
texture = ExtResource("7_60v0s")

[node name="DetectStartingLineReached" type="Node" parent="."]
script = ExtResource("8_ouh8i")

[node name="StartingLineArea2D" type="Area2D" parent="DetectStartingLineReached"]
position = Vector2(207, 570)

[node name="CollisionShape2D" type="CollisionShape2D" parent="DetectStartingLineReached/StartingLineArea2D"]
scale = Vector2(-4.61429, -2.53186)
shape = SubResource("RectangleShape2D_saorr")

[node name="LollipopBaseBrown" type="Sprite2D" parent="DetectStartingLineReached/StartingLineArea2D"]
position = Vector2(-2, 34)
texture = ExtResource("6_1swtq")

[node name="LollipopFruitGreen" type="Sprite2D" parent="DetectStartingLineReached/StartingLineArea2D"]
position = Vector2(-2, -37)
texture = ExtResource("7_bwe1x")

[node name="Control" type="Control" parent="."]
custom_minimum_size = Vector2(1080, 720)
layout_mode = 3
anchors_preset = 0
offset_right = 40.0
offset_bottom = 40.0

[node name="PanelContainer" type="PanelContainer" parent="Control"]
custom_minimum_size = Vector2(200, 100)
layout_mode = 1
anchors_preset = 1
anchor_left = 1.0
anchor_right = 1.0
offset_left = -200.0
offset_top = 2.0
offset_bottom = 146.0
grow_horizontal = 0
size_flags_horizontal = 3
size_flags_vertical = 0

[node name="Instructions" type="VBoxContainer" parent="Control/PanelContainer"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 8
size_flags_vertical = 0
script = ExtResource("8_sdu8k")

[node name="GoInstruction" type="HBoxContainer" parent="Control/PanelContainer/Instructions"]
custom_minimum_size = Vector2(200, 0)
layout_mode = 2
size_flags_horizontal = 0
size_flags_vertical = 0

[node name="Label" type="Label" parent="Control/PanelContainer/Instructions/GoInstruction"]
layout_mode = 2
size_flags_horizontal = 3
text = "Go !"

[node name="TextureRect" type="TextureRect" parent="Control/PanelContainer/Instructions/GoInstruction"]
layout_mode = 2
size_flags_horizontal = 8
texture = ExtResource("8_06u38")

[node name="StopInstruction" type="HBoxContainer" parent="Control/PanelContainer/Instructions"]
layout_mode = 2
size_flags_vertical = 0

[node name="Label" type="Label" parent="Control/PanelContainer/Instructions/StopInstruction"]
layout_mode = 2
size_flags_horizontal = 3
text = "Stop!"

[node name="TextureRect" type="TextureRect" parent="Control/PanelContainer/Instructions/StopInstruction"]
layout_mode = 2
size_flags_horizontal = 8
texture = ExtResource("4_7quu1")

[node name="AnnounceCommands" type="Node" parent="."]
script = ExtResource("13_d88ly")

[node name="Timer" type="Timer" parent="AnnounceCommands"]
wait_time = 2.0

[node name="CheckPlayerMovement" type="Node" parent="."]
script = ExtResource("14_yfcr8")

[connection signal="finished_line_reached" from="DetectFinishLineReached" to="AnnounceCommands" method="_on_detect_finish_line_reached_finished_line_reached"]
[connection signal="body_entered" from="DetectFinishLineReached/FinishLineArea2D" to="DetectFinishLineReached" method="_on_finish_line_area_2d_body_entered"]
[connection signal="entered_play_area" from="DetectStartingLineReached" to="AnnounceCommands" method="_on_detect_starting_line_reached_entered_play_area"]
[connection signal="body_entered" from="DetectStartingLineReached/StartingLineArea2D" to="DetectStartingLineReached" method="_on_starting_line_area_2d_body_entered"]
[connection signal="go_announced" from="Control/PanelContainer/Instructions" to="CheckPlayerMovement" method="_on_instructions_go_announced"]
[connection signal="stop_announced" from="Control/PanelContainer/Instructions" to="CheckPlayerMovement" method="_on_instructions_stop_announced"]
[connection signal="timeout" from="AnnounceCommands/Timer" to="AnnounceCommands" method="_on_timer_timeout"]
[connection signal="player_has_moved" from="CheckPlayerMovement" to="Player/MoveCharacterBack" method="_on_check_player_movement_player_has_moved"]
